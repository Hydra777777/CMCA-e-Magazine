<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMCA 40th Anniversary Magazine</title>
    <!-- Favicon -->
    <link rel="icon" href="Images\favicon.png" type="image/png">
    <!-- Tailwind CSS CDN for basic styling -->
    <style>
        /* Ensure html and body take full viewport height */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent body scroll */
        }

        /* Custom CSS for the magazine container and pages */
        body {
            font-family: "Inter", sans-serif; /* Using Inter font as per instructions */
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #1a202c; /* Dark mode body background */
            color: #e2e8f0; /* Light text color for dark mode */
        }

        #magazine {
            /* Initial dimensions for larger screens */
            width: 800px;
            height: 500px;
            background-color: #2d3748; /* Dark mode magazine background */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); /* Stronger shadow for dark mode */
            border-radius: 8px; /* Rounded corners for the magazine */
            overflow: hidden; /* Important for turn.js */
        }

        #magazine .page {
            background-color: #2d3748; /* Dark mode page background */
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* Ensure images don't overflow their page */
        }

        #magazine .page img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* Ensure image fits within the page without cropping */
            border-radius: 4px; /* Slightly rounded corners for images */
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 900px) {
            #magazine {
                width: 90vw; /* Use viewport width for responsiveness */
                height: calc(90vw * (500 / 800)); /* Maintain aspect ratio */
            }
        }

        @media (max-width: 600px) {
            #magazine {
                width: 95vw; /* Even wider for very small screens */
                height: calc(95vw * (500 / 800)); /* Maintain aspect ratio */
            }
        }

        /* Ensure magazine doesn't exceed viewport height on very tall/narrow screens */
        @media (max-height: 600px) {
            #magazine {
                height: 90vh;
                width: calc(90vh * (800 / 500)); /* Adjust width to maintain aspect ratio */
            }
        }
    </style>
</head>
<body class="bg-gray-900 flex items-center justify-center"> <!-- Updated Tailwind class for dark body -->

    <div id="magazine" class="relative rounded-lg shadow-xl">
        <!-- Page 1: Cover Page -->
        <div class="page">
            <img src="https://placehold.co/400x500/374151/D1D5DB?text=Cover+Page" alt="Cover Page">
        </div>
        <!-- Page 2: Inside Left -->
        <div class="page">
            <img src="https://placehold.co/400x500/4B5563/F9FAFB?text=Page+2" alt="Page 2 Content">
        </div>
        <!-- Page 3: Inside Right -->
        <div class="page">
            <img src="https://placehold.co/400x500/4B5563/F9FAFB?text=Page+3" alt="Page 3 Content">
        </div>
        <!-- Page 4: Next Left -->
        <div class="page">
            <img src="https://placehold.co/400x500/374151/D1D5DB?text=Page+4" alt="Page 4 Content">
        </div>
        <!-- Page 5: Next Right -->
        <div class="page">
            <img src="https://placehold.co/400x500/374151/D1D5DB?text=Page+5" alt="Page 5 Content">
        </div>
        <!-- Page 6: Back Cover -->
        <div class="page">
            <img src="https://placehold.co/400x500/2D3748/E2E8F0?text=Back+Cover" alt="Back Cover">
        </div>
        <!-- Add more pages as needed following the same structure -->
    </div>

    <!-- jQuery is a dependency for turn.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- turn.js library - Updated to the official CDN link -->
    <script src="http://www.turnjs.com/lib/turn.min.js"></script>

    <script>
        // Ensure the DOM is fully loaded before initializing turn.js
        $(document).ready(function() {
            // Log to confirm document ready
            console.log("Document is ready. Attempting to initialize turn.js.");

            // Function to initialize or resize the magazine, dynamically setting display mode
            function initializeMagazine(currentPage = 1) { // currentPage parameter is now less critical for display mode
                var magazine = $('#magazine');
                var currentWidth = magazine.width();
                var currentHeight = magazine.height();
                // var totalPages = magazine.find('.page').length; // No longer needed for display mode logic

                if ($.fn.turn) {
                    console.log("turn.js function found.");

                    // Always set displayMode to 'double' as requested
                    var displayMode = 'double';

                    if (magazine.data('turn-page') === undefined) {
                        console.log("Initializing magazine for the first time with display:", displayMode);
                        magazine.turn({
                            width: currentWidth,
                            height: currentHeight,
                            autoCenter: true,
                            gradients: true,
                            acceleration: true,
                            display: displayMode, // Always use double display mode
                            duration: 1000,
                        });
                    } else {
                        // If already initialized, just update display and size
                        console.log("Updating existing magazine display to:", displayMode);
                        magazine.turn('display', displayMode); // Change display mode
                        magazine.turn('size', currentWidth, currentHeight);
                    }

                } else {
                    console.error("Error: turn.js function not found. Ensure the script is loaded correctly.");
                }
            }

            // Load all images first, then initialize turn.js
            var images = $('#magazine').find('img');
            var loadedImages = 0;
            var totalImages = images.length;

            if (totalImages === 0) {
                initializeMagazine();
            } else {
                images.each(function() {
                    if (this.complete) {
                        loadedImages++;
                    } else {
                        $(this).on('load', function() {
                            loadedImages++;
                            if (loadedImages === totalImages) {
                                initializeMagazine();
                            }
                        }).on('error', function() {
                            console.error("Error loading image:", this.src);
                            loadedImages++;
                            if (loadedImages === totalImages) {
                                initializeMagazine();
                            }
                        });
                    }
                });
                if (loadedImages === totalImages) {
                    initializeMagazine();
                }
            }

            // Optional: Add keyboard navigation
            $(document).keydown(function(e){
                var magazine = $('#magazine');
                if (e.keyCode == 37) { // Left arrow key
                    magazine.turn('previous');
                    e.preventDefault(); // Prevent default browser action (scrolling)
                } else if (e.keyCode == 39) { // Right arrow key
                    magazine.turn('next');
                    e.preventDefault(); // Prevent default browser action (scrolling)
                }
            });

            // Listen for the 'turned' event to re-evaluate display mode and centering
            $('#magazine').on('turned', function(event, page, view) {
                // When a page is turned, re-initialize/resize with the correct display mode for the new page
                initializeMagazine(page); // Pass the new page number (though display mode is now fixed to 'double')
            });

            // Handle window resize to make the magazine responsive
            $(window).on('resize', function() {
                // On resize, re-initialize/resize with the current page's display mode
                initializeMagazine($('#magazine').turn('page'));
            });
        });
    </script>
</body>
</html>
